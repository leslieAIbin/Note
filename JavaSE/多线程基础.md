---
typora-root-url: /images
---





# 多线程基础

# 线程、进程、多线程

## 多任务

边吃饭，边玩手机

上厕所+玩手机

## 多线程

很多人一条道很堵，就用了很多车道 可以提高效率 解决阻塞问题



![](/18.png)



![](/19.png)





Process 进程

Thread 线程

![](/20.png)





![](/21.png)



# 线程创建



main函数 用户线程

gc线程 守护线程

![](/22.png)





![](/23.png)







![](/24.png)





# 实现Runnable接口

![](/25.png)





![](/26.png)





# 实现Callable接口

![](/27.png)

# 静态代理



![](/28.png)





# Lamba

![](/29.png)





![](/30.png)



![](/31.png)



函数式接口

```java
public interface Runnable {
    public abstract void run();
}
```



# 线程状态



![](/32.png)



![](/33.png)





 

![](/34.png)





![](/35.png)









# 线程休眠

![](/36.png)





最后一句话是重点





# 线程礼让

![](/37.png)





# 线程强制执行

![](/38.png)





# 观测线程的状态

![](/39.png)

https://www.matools.com/api/java8

Thread.State



# 线程的优先级

![](/40.png)



优先级低，只是意味着获得调度的概率低，并不是优先级低就不会被调用了，这都是看cpu的调度





# 守护线程



main 用户线程

gc 守护线程

![](/41.png)

# 线程同步机制

重点加难点

**多个线程操作同一个资源**

并发：同一个对象被多个线程同时操作

上万人同时抢票 两个银行同时取钱

![](/42.png)



很多人排队上厕所，这里厕所要关门，就是锁，排队就是队列。你不加锁，别人就会看到你拉屎的样子了

队列+锁 保证 线程同步的安全性



![](/43.png)



保证安全，就会失去性能 





# 三大不安全案例



这里的代码见syn包

同时看到1 ，放入自己这里，1 -> 0 -> -1

![](/44.png)



 ![](/45.png)



锁的是增删改查的对象，也就是共享资源



# 同步方法及同步块

![](/46.png)

# CopyOnWriteArrayList



# 死锁

![](/47.png)





![](/48.png)



# Lock锁



![](/49.png)



可重入锁 ReentrantLock



![](/50.png)

# 生产者消费者问题

线程通信

![](/51.png)





![](/52.png)





![](/53.png)



![](/54.png)



![](/55.png)

# 管程法



# 信号灯法



这两种都是多线程通信的模式





# 线程池



![](/56.png)



类似共享单车  





![](/57.png)